# Prototype-Siamese-Networks

This project focuses on detecting fake news on social media by proposing a fake news classifier that employs language-agnostic features, called Prototypes' Siamese Neural Network (P-SN).  

## Data

The experimental data comes from two datasets: Twitter 15 and Twitter 16. The original data can be downloaded from its original source (https://www.dropbox.com/s/7ewzdrbelpmrnxu/rumdetect2017.zip). These datasets contain complete information about the propagation of a news item. The propagation tree represents each interaction as a node, which includes the user ID, post ID, and timestamp in minutes. To retrieve information about users and posts, it is necessary to use the Twitter API. The news items are labelled into four categories: non-rumour, true rumour, false rumour, and unverified rumour.  

## Data modeling

This project aims to work with contextual and language-agnostic features, which are represented as time series. These time series, referred to as temporal footprints, are generated over a fixed time window (e.g., the first 12 hours of propagation), where a sequence of intervals of length \( L \) is defined. Within each interval, the count of selected features in the temporal footprint is recorded, which can be one of the following indicators: number of posts, retweets, replies, total number of tweets (volume), distinct users participating in the propagation, followers, and friends of the users involved in the propagation. Each temporal footprint of a news item is conditioned on a specific indicator. Thus, the final representation of a news item is a stack of temporal footprints. To generate the temporal footprints, the file `get_time_series.py` must be included as a library. The function `get_interactions` is used to extract the time series for the indicators: number of posts, retweets, replies, and total number of tweets (volume). Meanwhile, the function `get_fingerprints` extracts the time series for the remaining indicators. To obtain the final representation of a news item, the function `get_multivariate_series` should be used, which includes preprocessing options for time series through the `scale` parameter.  

## Siamese networks

A Siamese neural network takes two inputs and determines their similarity. One input serves as a reference, while the other is an example being evaluated. In this project, the reference input corresponds to a news prototype (a stack of temporal footprints) belonging to a specific veracity class. To generate these prototypes, two approaches are proposed. The first involves using clustering algorithms, which can be applied using the file `Prototypes(kmeans+khmetis).ipynb`. The second approach relies on deep learning algorithms, specifically by using the file `SOM_VAE_Time_Series.ipynb`, which requires the `utils.py` file as a library. The training of the network is conducted in the file `P-SN.ipynb`. A dataset of pairs is created, where a news item is paired with \( x \) prototypes of the same class, resulting in \( y=0 \) for the Siamese network, and also paired with \( x \) prototypes from a different class, resulting in \( y=1 \) for the Siamese network. The Siamese network employs a feed-forward neural network \( G \) with two hidden layers as the complementary or encoding network. This encoder maps the inputs to a shared latent space, where the Euclidean distance is used to measure similarity. The contrastive loss function is applied during training.  

## Evaluation

The final classification of a news item is also conducted in the `P-SN.ipynb` file. When evaluating a news item, it is first paired with all the generated prototypes. Each pair is then evaluated by the Prototypes' Siamese Neural Network, which calculates the similarity score for each pair. This information is fed into a multi-layer perceptron, which aligns the similarity information with the four credibility classes used in this study. Additionally, a hybrid method is proposed, which integrates the time series-based model with content-based features such as textual data, analysed using the recursive model RvNN-GA. The proposed method is compared with various related studies, some of which have implementations available on GitHub, such as RvNN-GA (https://github.com/majingCUHK/Rumor_RvNN) and CSI (https://github.com/sungyongs/CSI-Code).
